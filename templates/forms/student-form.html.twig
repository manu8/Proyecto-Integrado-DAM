{% extends 'layout.html.twig' %}

{% block breadcrumbs %}
	<li><a href="{{ path('home') }}"><i class="fi-home small-icon"></i></a></li>
	<li class="current"><i class="fi-torso small-icon"></i></li>
{% endblock %}

{% block content %}
	{% if new_student is defined %}
    <div class="custom-row first-row">
	    <div class="small-6 small-centered column">
	      <div data-alert class="alert-box success round text-center">
	        ¡Alumno creado!
	        <a href="#" class="close">&times;</a>
	      </div>
	    </div>
	  </div>
  {% endif %}
  {% if update_student is defined %}
    <div class="custom-row first-row">
      <div class="small-6 small-centered column">
        <div data-alert class="alert-box info round text-center">
          ¡Alumno modificado!
          <a href="#" class="close">&times;</a>
        </div>
      </div>
    </div>
  {% endif %}
  {% if add_studies is defined %}
    <div class="custom-row first-row">
      <div class="small-6 small-centered column">
        <div data-alert class="alert-box info round text-center">
          ¡Estudios añadidos!
          <a href="#" class="close">&times;</a>
        </div>
      </div>
    </div>
  {% endif %}
  {% if add_knowledges is defined %}
    <div class="custom-row first-row">
      <div class="small-6 small-centered column">
        <div data-alert class="alert-box info round text-center">
          ¡Conocimientos añadidos!
          <a href="#" class="close">&times;</a>
        </div>
      </div>
    </div>
  {% endif %}
  {% if add_companies is defined %}
    <div class="custom-row first-row">
      <div class="small-6 small-centered column">
        <div data-alert class="alert-box info round text-center">
          ¡Empresas añadidas!
          <a href="#" class="close">&times;</a>
        </div>
      </div>
    </div>
  {% endif %}
  <div class="row">
    <div class="small-12 column">
      <form
          {% if form_type == 'new' %}
            action="{{ path('student_new') }}"
          {% else %}
            action="{{ path('student_update') }}"
          {% endif %}
          method="post" data-abide>
        <fieldset>
          <legend>Datos del Alumno</legend>
          <div class="row collapse">
            <div class="small-2 column">
              <span class="prefix"><i class="fi-credit-card medium-icon"></i></span>
            </div>
            <div class="small-10 column">
              <input type="text" placeholder="NIF" pattern="[\d{8}\w{1}]" name="nif"
                  {% if student is defined and student is not null %}
                    value="{{ student.NIF }}"
                  {% endif %}
              required/>
              <small class="error">Debe indicar un NIF válido</small>
            </div>
          </div>
          <div class="row collapse">
            <div class="small-2 column">
              <span class="prefix">Nombre</span>
            </div>
            <div class="small-10 medium-4 large-4 columns">
              <input type="text" placeholder="Nombre" pattern="alpha" name="nombre"
                  {% if student is defined and student is not null %}
                    value="{{ student.Nombre }}"
                  {% endif %}
              required/>
              <small class="error">Debe indicar un nombre válido</small>
            </div>
            <div class="large-2 column show-for-medium-up">
              <span class="prefix">Apellidos</span>
            </div>
            <div class="medium-4 large-4 columns show-for-medium-up">
              <input type="text" placeholder="Apellidos" pattern="surnames" name="apellidos"
                  {% if student is defined and student is not null %}
                    value="{{ student.Apellidos }}"
                  {% endif %}
              required/>
              <small class="error">Debe indicar unos apellidos válidos</small>
            </div>
          </div>
          <div class="row collapse show-for-small-only">
            <div class="small-2 column">
              <span class="prefix">Apellidos</span>
            </div>
            <div class="small-10 column">
              <input type="text" placeholder="Apellidos" pattern="surnames" name="small_apellidos"
                  {% if student is defined and student is not null %}
                    value="{{ student.Apellidos }}"
                  {% endif %}
              required/>
              <small class="error">Debe indicar unos apellidos válidos</small>
            </div>
          </div>
          <div class="row collapse">
            <div class="small-2 column">
              <span class="prefix"><i class="fi-map medium-icon"></i></span>
            </div>
            <div class="small-10 medium-6 large-6 columns">
              <input type="text" placeholder="Dirección" name="direccion"
                  {% if student is defined and student is not null %}
                    value="{{ student.Direccion }}"
                  {% endif %}/>
            </div>
            <div class="large-2 column show-for-medium-up">
              <span class="prefix">CP</span>
            </div>
            <div class="medium-2 large-2 columns show-for-medium-up">
              <input type="text" placeholder="CP" name="cp"
                  {% if student is defined and student is not null %}
                    value="{{ student.CP }}"
                  {% endif %}/>
            </div>
          </div>
          <div class="row collapse show-for-small-only">
            <div class="small-2 column">
              <span class="prefix">CP</span>
            </div>
            <div class="small-10 column">
              <input type="text" placeholder="CP" name="small_cp"
                  {% if student is defined and student is not null %}
                    value="{{ student.CP }}"
                  {% endif %}/>
            </div>
          </div>
          <div class="row collapse">
            <div class="small-2 column">
              <span class="prefix"><i class="fi-telephone medium-icon"></i></span>
            </div>
            <div class="small-10 medium-3 large-3 columns">
              <input type="text" placeholder="Teléfono" pattern="tlf" name="telefono"
                  {% if student is defined and student is not null %}
                    {{ student.Telefono }}
                  {% endif %}
              required/>
              <small class="error">Debe indicar un número de teléfono válido</small>
            </div>
            <div class="large-2 column show-for-medium-up">
              <span class="prefix"><i class="fi-mail medium-icon"></i></span>
            </div>
            <div class="medium-5 large-5 columns show-for-medium-up">
              <input type="text" placeholder="Email" pattern="email" name="email"
                  {% if student is defined and student is not null %}
                    value="{{ student.Email }}"
                  {% endif %}
              required/>
              <small class="error">Debe indicar un email válido</small>
            </div>
          </div>
          <div class="row collapse show-for-small-only">
            <div class="small-2 column">
              <span class="prefix"><i class="fi-mail medium-icon"></i></span>
            </div>
            <div class="small-10 column">
              <input type="text" placeholder="Email" pattern="email" name="small_email"
                  {% if student is defined and student is not null %}
                    value="{{ student.Email }}"
                  {% endif %}
              required/>
              <small class="error">Debe indicar un email válido</small>
            </div>
          </div>
          <div class="row list">
            <h3>Estudios y Títulos</h3>
            {% if student is defined and student is not null %}
              <table class="centered">
                <thead>
                <tr>
                  <th>Denominación</th>
                  <th>Acciones</th>
                </tr>
                </thead>
                <tbody>
                {% for study in student.Estudios_Titulos %}
                  <tr>
                    <td>{{ study.Denominacion }}</td>
                    <td>
                      {% if is_granted('ROLE_USER') %}
                        <ul class="button-group round even-2">
                          <li><a class="button warning" href="{{ path('study_edit') }}"><i class="fi-page-edit"></i></a></li>
                          <li><a class="button alert" href="{{ path('remove_student_study') }}"><i class="fi-x"></i></a></li>
                        </ul>
                      {% endif %}
                    </td>
                  </tr>
                {% endfor %}
                </tbody>
              </table>
            {% else %}
              <p class="text-center"><span class="warning round label">No existen estudios asociados</span></p>
            {% endif %}
          </div>
          <div class="row list">
            <h3>Conocimientos y Habilidades</h3>
            {% if student is defined and student is not null %}
              <table class="centered">
                <thead>
                <tr>
                  <th>Denominación</th>
                  <th>Descripción</th>
                  <th>Acciones</th>
                </tr>
                </thead>
                <tbody>
                {% for knowledge in student.Conocimiento_Habilidades %}
                  <tr>
                    <td>{{ knowledge.Denominacion }}</td>
                    <td>{{ knowledge.Descripcion }}</td>
                    <td>
                      {% if is_granted('ROLE_USER') %}
                        <ul class="button-group round even-2">
                          <li><a class="button warning" href="{{ path('knowledge_edit') }}"><i class="fi-page-edit"></i></a></li>
                          <li><a class="button alert" href="{{ path('remove_user_knowledge') }}"><i class="fi-x"></i></a></li>
                        </ul>
                      {% endif %}
                    </td>
                  </tr>
                {% endfor %}
                </tbody>
              </table>
            {% else %}
              <p class="text-center"><span class="warning round label">No existen conocimientos asociados</span></p>
            {% endif %}
          </div>
          <div class="row list">
            <h3>Empresas</h3>
            {% if student is defined and student is not null %}
              <table class="centered">
                <thead>
                <tr>
                  <th>Denominación</th>
                  <th>Dirección</th>
                  <th>Tlf.</th>
                  <th>Email</th>
                  <th>Acciones</th>
                </tr>
                </thead>
                <tbody>
                {% for company in student.Empresas %}
                  <tr>
                    <td>{{ company.Denominacion }}</td>
                    <td>{{ company.Direccion }}&nbsp;-&nbsp;{{ company.CP }}</td>
                    <td>{{ company.Telefono }}</td>
                    <td>{{ company.Email }}</td>
                    <td>
                      {% if is_granted('ROLE_USER') %}
                        <ul class="button-group round even-2">
                          <li><a class="button warning" href="{{ path('company_edit') }}"><i class="fi-page-edit"></i></a></li>
                          <li><a class="button alert" href="{{ path('remove_user_company') }}"><i class="fi-x"></i></a></li>
                        </ul>
                      {% endif %}
                    </td>
                  </tr>
                {% endfor %}
                </tbody>
              </table>
            {% else %}
              <p class="text-center"><span class="warning round label">No existen empresas asociados</span></p>
            {% endif %}
          </div>
          <div class="row small-centered">
            <div class="small-12 medium-3 large-3 columns">
              {% if form_type == 'edit' and is_granted('ROLE_USER') %}
                <button type="submit" class="button expand round warning"><i class="small-icon fi-pencil"></i>Modificar alumno</button>
              {% else %}
                <button type="submit" class="button expand round success"><i class="small-icon fi-plus"></i>Registrar alumno</button>
              {% endif %}
            </div>
            {% if form_type == 'new' %}
              <div class="small-12 medium-3 large-3 columns">
                <button type="reset" class="button expand round alert"><i class="small-icon fi-trash"></i>Limpiar</button>
              </div>
            {% endif %}
            <div class="small-12 medium-3 large-3 columns">
              <a href="{{ path('student_lists') }}" class="button round"><i class="small-icon fi-list-thumbnails"></i>Ir al listado</a>
            </div>
          </div>
          {% if form_type == 'edit' %}
            <div class="row small-centered">
              <div class="small-12 column">
                <ul class="button-group round even-3">
                  <li><a href="{{ path('add_studies') }}" class="button"><i class="fi-plus"></i>&nbsp;Añadir estudio(s)</a></li>
                  <li><a href="{{ path('add_knowledges') }}" class="button"><i class="fi-plus"></i>&nbsp;Añadir conocimiento(s)</a></li>
                  <li><a href="{{ path('add_companies') }}" class="button"><i class="fi-plus"></i>&nbsp;Añadir empresa(s)</a></li>
                </ul>
              </div>
            {% endif %}
          </div>
        </fieldset>
      </form>
    </div>
  </div>
{% endblock %}